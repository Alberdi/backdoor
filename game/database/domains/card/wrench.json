{
  "desc":"Deal XdCOR damage where X=5+nearby machines",
  "widget":{
    "operators":[],
    "trigger":"on_use",
    "activation":{
      "cost":20,
      "ability":{
        "params":[{
            "typename":"choose_target",
            "max-range":1,
            "body-only":[],
            "output":"pos"
          }],
        "operators":[{
            "typename":"get_attribute",
            "output":"cor",
            "which":"COR"
          },{
            "typename":"self",
            "output":"self"
          },{
            "typename":"get_actor_body",
            "output":"body",
            "actor":"val:self"
          },{
            "typename":"get_body_pos",
            "body":"val:body",
            "output":"center"
          },{
            "pos":"val:center",
            "typename":"count_nearby_bodies",
            "body-type":"machine",
            "output":"count",
            "range":5
          },{
            "op":"+",
            "typename":"integer_binop",
            "rhs":5,
            "output":"base",
            "lhs":"val:count"
          },{
            "typename":"get_body_at",
            "pos":"par:pos",
            "output":"target"
          }],
        "effects":[{
            "typename":"damage_on_target",
            "target":"val:target",
            "base":"val:base",
            "attr":"val:cor"
          }]
      }
    },
    "charges":10,
    "placement":"weapon"
  },
  "attr":"COR",
  "name":"Wrench"
}